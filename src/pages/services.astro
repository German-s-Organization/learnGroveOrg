---
import PageLayout from '../layouts/PageLayout.astro';
import { ServicesView } from '../components/services/ServicesMain';
import { getLangFromUrl, useTranslations } from '../i18n/utils';
import { supabase } from "../lib/supabaseClient";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const { data: session, error: sessionError } = await supabase.auth.getSession();

if (sessionError) {
    console.log(sessionError);
}

if (session.session === null || session.session === undefined) {
    alert(t('messages.signIn')); //TODO: This only redenders on the server, add explanation for client
    return Astro.redirect(`${lang}/login`);
}
---

<PageLayout pageTitle={t('pageTitles.services')} >
    <div class="text-center mt-4 mb-8 bg-primaryBackground w-full">
    <div class="text-center mt-4 mb-8">
        <h2 class="text-xl w-full italic">{t('pageTitles.services')}</h2>
        <ServicesView client:only="solid-js" />
    </div>
</PageLayout>